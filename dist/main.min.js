$(document).ready(()=>{$(".team__title").on("click",function(e){e.preventDefault();let t=$(this).siblings(".team__content");const a=$(this).parent(".team__item");a.siblings(".team__item").find(".team__content").css("height",0),$(this).parent().toggleClass("active"),$(this).parent().hasClass("active")?($(this).parent().siblings().removeClass("active"),t.css("height",t.prop("scrollHeight")+"px")):t.css("height",0)})}),$(".board-menu__item").on("click",function(e){e.preventDefault();e=window.matchMedia("(max-width: 768px)").matches;const t=$(this).find(".bm-item__content");$(this).siblings().find(".bm-item__content").css("width",0),$(this).toggleClass("active"),$(this).hasClass("active")?($(this).siblings().removeClass("active"),e?t.css("width",$(window).width()-$(this).find(".bm-item__header").width()*$(this).parent(".board-menu").find(".bm-item__header").length):t.css("width","500px")):t.css("width",0)}),function(){const e=document.querySelector("#humburger"),t=document.querySelector(".fullscrean-menu"),a=document.querySelector(".fullscrean-menu__close"),s=document.body;e.addEventListener("click",e=>{t.classList.add("active"),s.classList.add("body-wrapper"),a.addEventListener("click",e=>{t.classList.remove("active"),s.classList.remove("body-wrapper")})})}(),ymaps.ready(()=>{const e=new ymaps.Map("map",{center:[55.796627,49.119409],zoom:13,controls:[]});const t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/marker.svg",iconImageSize:[44,54],iconImageOffset:[-3,-42]});[[55.791805,49.113666],[55.809899,49.093185],[55.822082,49.142545]].forEach(e=>{t.add(new ymaps.Placemark(e))}),e.geoObjects.add(t),e.behaviors.disable("scrollZoom")}),$(".form").submit(e=>{e.preventDefault();const t=$(e.currentTarget),a=t.find("[name='name']"),s=t.find("[name='phone']"),n=t.find("[name='comment']"),i=t.find("[name='to']");[a,s,n,i].forEach(e=>{e.removeClass("form__input-error"),""===e.val().trim()&&e.addClass("form__input-error")});const o=$(".modal"),r=o.find(".modal__content");r.removeClass("error__modal"),errorField=t.find(".form__input-error"),0===errorField.length&&$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:a.val(),phone:s.val(),comment:n.val(),to:i.val()},success:e=>{r.text(e.message),$.fancybox.open({src:"#modal",type:"inline"})},error:e=>{e=e.responseJSON.message;r.text(e),r.addClass("error__modal"),$.fancybox.open({src:"#modal",type:"inline"})}}),$(".js__submit-btn").click(e=>{e.preventDefault(),$.fancybox.close()})}),function(){const s=$(".section"),a=$(".maincontent"),n=$(".fixed-menu");let i=!1;s.first().addClass("active");const o=e=>{var t;!1===i&&(i=!0,t=-100*e,(e=>{const t=s.eq(e);"black"===t.attr("data-sidemenu-theme")?n.addClass("fixed-menu_shadowed"):n.removeClass("fixed-menu_shadowed")})(e),a.css({transform:`translateY(${t}%)`}),s.eq(e).addClass("active").siblings().removeClass("active"),n.find(".fixed-menu__item").eq(e).addClass("active").siblings().removeClass("active"),setTimeout(()=>{i=!1},1300))},r=()=>{const e=s.filter(".active"),t=e.next(),a=e.prev();return{next(){t.length&&o(t.index())},prev(){a.length&&o(a.index())}}};$(window).on("wheel",e=>{if(!$(".fullscrean-menu").hasClass("active")){e=e.originalEvent.deltaY;const t=r();0<e&&t.next(),e<0&&t.prev()}}),$(window).on("keydown",e=>{if(!$(".fullscrean-menu").hasClass("active")){var t=e.target.tagName.toLocaleLowerCase();const a=r();if("input"!==t&&"textarea"!==t)switch(e.keyCode){case 38:a.prev();break;case 40:a.next()}}}),$("[data-scroll-to]").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-scroll-to");const a=$(`[data-section-id=${e}]`);o(a.index()),$(".fullscrean-menu").removeClass("active")}),$("body").swipe({swipe:function(e,t){const a=r();let s="down"===t?"prev":"up"===t?"next":"";a[s]()}})}(),function(){const t=document.querySelector(".products"),a=$(".product-item").length;$(".product-slider__arrows");const e=$(".product-slider__arrow--left"),s=$(".product-slider__arrow--right");let n=0;const i=document.querySelector(".product-item").clientWidth;e.on("click",function(e){e.preventDefault(),0<n?n--:n=a-1,t.style.left="-"+n*i+"px"}),s.on("click",function(e){e.preventDefault(),n!==a-1?n++:n=0,t.style.left="-"+n*i+"px"})}(),$(document).ready(()=>{$(".interactive-avatar__link").on("click",function(e){e.preventDefault();const t=$(e.currentTarget);var a,e=t.attr("data-open");const s=(a=e,$(".reviews__item").filter((e,t)=>$(t).attr("data-linked-with")===a)),n=t.closest(".reviews__switchcer-item");s.addClass("active").siblings().removeClass("active"),n.addClass("active").siblings().removeClass("active")})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGlvbiB2ZXJ0aWNhbC5qcyIsImFjY29yZGlvbi5qcyIsImh1bWJ1cmdlci5qcyIsIm1hcC5qcyIsIm1vZGFsLmpzIiwib3BjLmpzIiwic2xpZGVyLmpzIiwidGFicy5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIm9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwidGVhbUNvbnRlbnQiLCJ0aGlzIiwic2libGluZ3MiLCJ0ZWFtSXRlbSIsInBhcmVudCIsImZpbmQiLCJjc3MiLCJ0b2dnbGVDbGFzcyIsImhhc0NsYXNzIiwicmVtb3ZlQ2xhc3MiLCJwcm9wIiwiaXNNb2JpbCIsIndpbmRvdyIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwibWVudUNvbnRlbnQiLCJ3aWR0aCIsImxlbmd0aCIsImh1bWJ1cmdlciIsInF1ZXJ5U2VsZWN0b3IiLCJmdWxsTWVudSIsImZ1bGxNZW51Q2xvc2UiLCJib2R5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInltYXBzIiwibXlNYXAiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJteUNvbGxlY3Rpb24iLCJHZW9PYmplY3RDb2xsZWN0aW9uIiwiZHJhZ2dhYmxlIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiZm9yRWFjaCIsImNvb3JkIiwiUGxhY2VtYXJrIiwiZ2VvT2JqZWN0cyIsImJlaGF2aW9ycyIsImRpc2FibGUiLCJzdWJtaXQiLCJmb3JtIiwiY3VycmVudFRhcmdldCIsIm5hbWUiLCJwaG9uZSIsImNvbW1lbnQiLCJ0byIsImVsZW1lbnQiLCJ2YWwiLCJ0cmltIiwiYWRkQ2xhc3MiLCJtb2RhbCIsImNvbnRlbnQiLCJlcnJvckZpZWxkIiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJzdWNjZXNzIiwidGV4dCIsIm1lc3NhZ2UiLCJmYW5jeWJveCIsIm9wZW4iLCJzcmMiLCJ0eXBlIiwiZXJyb3IiLCJyZXNwb25zZUpTT04iLCJjbGljayIsImNsb3NlIiwic2VjdGlvbnMiLCJkaXNwbGF5Iiwic2lkZW1lbnUiLCJpblNjcm9sbCIsImZpcnN0IiwicGVyZm9tVHJhbnNpdGlvbiIsInNlY3Rpb25FcSIsInBvc2l0aW9uIiwiY3VycmVudFNlY3Rpb24iLCJlcSIsImF0dHIiLCJjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uIiwidHJhbnNmb3JtIiwic2V0VGltZW91dCIsInZpZXdwb3J0U2Nyb2xsZXIiLCJhY3RpdmVTZWN0aW9uIiwiZmlsdGVyIiwibmV4dFNlY3Rpb24iLCJuZXh0IiwicHJldlNlY3Rpb24iLCJwcmV2IiwiaW5kZXgiLCJkZWx0YVkiLCJvcmlnaW5hbEV2ZW50Iiwic2Nyb2xsZXIiLCJ0YWdOYW1lIiwidGFyZ2V0IiwidG9Mb2NhbGVMb3dlckNhc2UiLCJrZXlDb2RlIiwiJHRoaXMiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsImRpcmVjdGlvbiIsInNjcm9sbERpcmVjdGlvbiIsInNsaWRlciIsIml0ZW1zQ291bnQiLCJhcnJvd0xlZnQiLCJhcnJvd1JpZ2h0Iiwic3RhcnRJbmRleCIsImNsaWVudFdpZHRoIiwic3R5bGUiLCJsZWZ0Iiwic2hvd0l0ZW0iLCJuZHgiLCJpdGVtIiwiYWxpYXMiLCJjdXJJdGVtIiwiY2xvc2VzdCJdLCJtYXBwaW5ncyI6IkFBQ0FBLEVBQUFDLFVBQUFDLE1BQUEsS0FDQUYsRUFBQSxnQkFBQUcsR0FBQSxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLGlCQUNBLElBQUFDLEVBQUFOLEVBQUFPLE1BQUFDLFNBQUEsa0JBQ0EsTUFBQUMsRUFBQVQsRUFBQU8sTUFBQUcsT0FBQSxlQUNBRCxFQUFBRCxTQUFBLGVBQUFHLEtBQUEsa0JBQUFDLElBQUEsU0FBQSxHQUNBWixFQUFBTyxNQUFBRyxTQUFBRyxZQUFBLFVBRUFiLEVBQUFPLE1BQUFHLFNBQUFJLFNBQUEsV0FDQWQsRUFBQU8sTUFBQUcsU0FBQUYs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QUYsRUFBQSw2QkFBQUcsR0FBQSxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLGlCQUVBLE1BQUF5RyxFQUFBOUcsRUFBQUksRUFBQWtELGVBQ0EsSUFWQSxFQVVBcUQsRUFBQUcsRUFBQW5CLEtBQUEsYUFDQSxNQUFBaUMsR0FYQSxFQVdBakIsRUFWQTNHLEVBQUEsa0JBQUFpRyxPQUFBLENBQUE0QixFQUFBQyxJQUNBOUgsRUFBQThILEdBQUFuQyxLQUFBLHNCQUFBb0MsSUFVQUMsRUFBQWxCLEVBQUFtQixRQUFBLDRCQUVBTCxFQUFBOUQsU0FBQSxVQUFBdEQsV0FBQU8sWUFBQSxVQUNBaUgsRUFBQWxFLFNBQUEsVUFBQXRELFdBQUFPLFlBQUEiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyI7KGZ1bmN0aW9uICgpe1xyXG4gICAgJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xyXG4gICAgICAgICQoJy50ZWFtX190aXRsZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBsZXQgdGVhbUNvbnRlbnQgPSAkKHRoaXMpLnNpYmxpbmdzKCcudGVhbV9fY29udGVudCcpO1xyXG4gICAgICAgICAgICBjb25zdCB0ZWFtSXRlbSA9ICQodGhpcykucGFyZW50KCcudGVhbV9faXRlbScpO1xyXG4gICAgICAgICAgICB0ZWFtSXRlbS5zaWJsaW5ncygnLnRlYW1fX2l0ZW0nKS5maW5kKCcudGVhbV9fY29udGVudCcpLmNzcygnaGVpZ2h0JywgMCk7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmKCQodGhpcykucGFyZW50KCkuaGFzQ2xhc3MoJ2FjdGl2ZScpKXtcclxuICAgICAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB0ZWFtQ29udGVudC5jc3MoJ2hlaWdodCcsIHRlYW1Db250ZW50LnByb3AoJ3Njcm9sbEhlaWdodCcpICsncHgnKTtcclxuICAgIFxyXG4gICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0ZWFtQ29udGVudC5jc3MoJ2hlaWdodCcsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxufSkoKSIsIjsoZnVuY3Rpb24gKCkge1xyXG4gICAgJCgnLmJvYXJkLW1lbnVfX2l0ZW0nKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IGlzTW9iaWwgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtYXgtd2lkdGg6IDc2OHB4KVwiKS5tYXRjaGVzO1xyXG4gICAgICAgIGNvbnN0IG1lbnVDb250ZW50ID0gJCh0aGlzKS5maW5kKCcuYm0taXRlbV9fY29udGVudCcpO1xyXG4gICAgICAgICQodGhpcykuc2libGluZ3MoKS5maW5kKCcuYm0taXRlbV9fY29udGVudCcpLmNzcygnd2lkdGgnLCAwKTtcclxuICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICAgICAgaWYoJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpe1xyXG4gICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgaWYoaXNNb2JpbCl7XHJcbiAgICAgICAgICAgICBtZW51Q29udGVudC5jc3MoJ3dpZHRoJywgJCh3aW5kb3cpLndpZHRoKCkgLSAkKHRoaXMpLmZpbmQoJy5ibS1pdGVtX19oZWFkZXInKS53aWR0aCgpICogJCh0aGlzKS5wYXJlbnQoJy5ib2FyZC1tZW51JykuZmluZCgnLmJtLWl0ZW1fX2hlYWRlcicpLmxlbmd0aCk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBtZW51Q29udGVudC5jc3MoJ3dpZHRoJywgJzUwMHB4Jyk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICBtZW51Q29udGVudC5jc3MoJ3dpZHRoJywgMCk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59KSgpIiwiOyhmdW5jdGlvbiAoKSB7IFxyXG5jb25zdCBodW1idXJnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaHVtYnVyZ2VyJyk7XHJcbiAgICAgICAgY29uc3QgZnVsbE1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZnVsbHNjcmVhbi1tZW51Jyk7XHJcbiAgICAgICAgY29uc3QgZnVsbE1lbnVDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mdWxsc2NyZWFuLW1lbnVfX2Nsb3NlJyk7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7XHJcblxyXG4gICAgICAgIGh1bWJ1cmdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xyXG4gICAgICAgICAgICBmdWxsTWVudS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxyXG4gICAgICAgICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ2JvZHktd3JhcHBlcicpXHJcblxyXG4gICAgICAgICAgICBmdWxsTWVudUNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XHJcbiAgICAgICAgICAgIGZ1bGxNZW51LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXHJcbiAgICAgICAgICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnYm9keS13cmFwcGVyJylcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0pO1xyXG59KSgpIiwiOyhmdW5jdGlvbiAoKXtcclxuY29uc3QgaW5pdCA9ICgpID0+IHtcclxuICAgIGNvbnN0IG15TWFwID0gbmV3IHltYXBzLk1hcChcIm1hcFwiLCB7XHJcbiAgICAgICAgY2VudGVyOiBbNTUuNzk2NjI3LCA0OS4xMTk0MDldLFxyXG4gICAgICAgIHpvb206IDEzLFxyXG4gICAgICAgIGNvbnRyb2xzOiBbXSBcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGNvb3JkcyA9IFtcclxuICAgICAgICBbNTUuNzkxODA1LCA0OS4xMTM2NjZdLFxyXG4gICAgICAgIFs1NS44MDk4OTksIDQ5LjA5MzE4NV0sXHJcbiAgICAgICAgWzU1LjgyMjA4MiwgNDkuMTQyNTQ1XVxyXG4gICAgXTtcclxuICAgIGNvbnN0IG15Q29sbGVjdGlvbiA9IG5ldyB5bWFwcy5HZW9PYmplY3RDb2xsZWN0aW9uKHt9LCB7XHJcbiAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcclxuICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgaWNvbkltYWdlSHJlZjogJy4vaW1nL21hcmtlci5zdmcnLFxyXG4gICAgICAgIGljb25JbWFnZVNpemU6IFs0NCwgNTRdLFxyXG4gICAgICAgIGljb25JbWFnZU9mZnNldDogWy0zLCAtNDJdXHJcbiAgICB9KTtcclxuICAgIGNvb3Jkcy5mb3JFYWNoKGNvb3JkID0+IHtcclxuICAgICAgICBteUNvbGxlY3Rpb24uYWRkKG5ldyB5bWFwcy5QbGFjZW1hcmsoY29vcmQpKTtcclxuICAgIH0pO1xyXG4gICAgbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlDb2xsZWN0aW9uKTtcclxuICAgIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7XHJcbn1cclxuXHJcbnltYXBzLnJlYWR5KGluaXQpO1xyXG59KSgpOyIsIjsoZnVuY3Rpb24gKCkgeyBcclxuICAgICQoJy5mb3JtJykuc3VibWl0KChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGZvcm0uZmluZChcIltuYW1lPSduYW1lJ11cIik7XHJcbiAgICAgICAgICAgIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWU9J3Bob25lJ11cIik7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xyXG4gICAgICAgICAgICBjb25zdCB0byA9IGZvcm0uZmluZChcIltuYW1lPSd0byddXCIpO1xyXG5cclxuICAgICAgICAgICAgW25hbWUsIHBob25lLCBjb21tZW50LCB0b10uZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJmb3JtX19pbnB1dC1lcnJvclwiKTtcclxuICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQudmFsKCkudHJpbSgpID09PSBcIlwiKXtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKFwiZm9ybV9faW5wdXQtZXJyb3JcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9kYWwgPSAkKFwiLm1vZGFsXCIpO1xyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gbW9kYWwuZmluZChcIi5tb2RhbF9fY29udGVudFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnRlbnQucmVtb3ZlQ2xhc3MoJ2Vycm9yX19tb2RhbCcpO1xyXG5cclxuICAgICAgICAgICAgZXJyb3JGaWVsZCA9IGZvcm0uZmluZChcIi5mb3JtX19pbnB1dC1lcnJvclwiKVxyXG5cclxuICAgICAgICAgICAgaWYoZXJyb3JGaWVsZC5sZW5ndGggPT09IDApe1xyXG4gICAgICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBob25lOiBwaG9uZS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG86IHRvLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogXCIjbW9kYWxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiaW5saW5lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLnJlc3BvbnNlSlNPTi5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuYWRkQ2xhc3MoJ2Vycm9yX19tb2RhbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZmFuY3lib3gub3Blbih7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcmM6IFwiI21vZGFsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiaW5saW5lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICQoXCIuanNfX3N1Ym1pdC1idG5cIikuY2xpY2soZSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICQuZmFuY3lib3guY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbiAgICB9KSgpOyIsIjsoZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3Qgc2VjdGlvbnMgPSAkKCcuc2VjdGlvbicpO1xyXG4gICAgY29uc3QgZGlzcGxheSA9ICQoJy5tYWluY29udGVudCcpO1xyXG4gICAgY29uc3Qgc2lkZW1lbnUgPSAkKCcuZml4ZWQtbWVudScpO1xyXG5cclxuXHJcbiAgICBsZXQgaW5TY3JvbGwgPSBmYWxzZTtcclxuXHJcbiAgICBzZWN0aW9ucy5maXJzdCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICBjb25zdCBjb3VudFNlY3Rpb25Qb3NpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHNlY3Rpb25FcSAqIC0xMDA7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcclxuICAgICAgICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IHNlY3Rpb25zLmVxKHNlY3Rpb25FcSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtZW51VGhlbWUgPSBjdXJyZW50U2VjdGlvbi5hdHRyKFwiZGF0YS1zaWRlbWVudS10aGVtZVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihtZW51VGhlbWUgPT09IFwiYmxhY2tcIil7XHJcbiAgICAgICAgICAgICAgICAgICAgc2lkZW1lbnUuYWRkQ2xhc3MoJ2ZpeGVkLW1lbnVfc2hhZG93ZWQnKVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgc2lkZW1lbnUucmVtb3ZlQ2xhc3MoJ2ZpeGVkLW1lbnVfc2hhZG93ZWQnKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgfVxyXG4gICBcclxuICAgIGNvbnN0IHBlcmZvbVRyYW5zaXRpb24gPSBzZWN0aW9uRXEgPT4ge1xyXG5cclxuICAgICAgICBpZihpblNjcm9sbD09PSBmYWxzZSl7XHJcblxyXG4gICAgICAgICAgICBpblNjcm9sbCA9IHRydWU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNvdW50U2VjdGlvblBvc2l0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gICAgICAgICAgICBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uKHNlY3Rpb25FcSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBkaXNwbGF5LmNzcyh7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgc2VjdGlvbnMuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcygnYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHNpZGVtZW51LmZpbmQoJy5maXhlZC1tZW51X19pdGVtJykuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcygnYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcblxyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpblNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9LCAxMzAwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgdmlld3BvcnRTY3JvbGxlciA9ICgpID0+IHtcclxuXHJcbiAgICAgICAgY29uc3QgYWN0aXZlU2VjdGlvbiA9IHNlY3Rpb25zLmZpbHRlcignLmFjdGl2ZScpO1xyXG4gICAgICAgIGNvbnN0IG5leHRTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5uZXh0KCk7XHJcbiAgICAgICAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcclxuXHJcbiAgICAgICAgcmV0dXJue1xyXG4gICAgICAgICAgICBuZXh0KCl7XHJcbiAgICAgICAgICAgICAgICBpZihuZXh0U2VjdGlvbi5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgcGVyZm9tVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcHJldigpIHtcclxuICAgICAgICAgICAgICAgIGlmKHByZXZTZWN0aW9uLmxlbmd0aCl7XHJcbiAgICAgICAgICAgICAgICAgICAgcGVyZm9tVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgJCh3aW5kb3cpLm9uKCd3aGVlbCcsIGUgPT4ge1xyXG4gICAgICAgIGlmKCQoJy5mdWxsc2NyZWFuLW1lbnUnKS5oYXNDbGFzcygnYWN0aXZlJykpIHJldHVyblxyXG4gICAgICAgIGNvbnN0IGRlbHRhWSA9IGUub3JpZ2luYWxFdmVudC5kZWx0YVk7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICBpZihkZWx0YVkgPiAwKSB7XHJcbiAgICAgICAgICAgIHNjcm9sbGVyLm5leHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKGRlbHRhWSA8IDApe1xyXG4gICAgICAgICAgICBzY3JvbGxlci5wcmV2KCk7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQod2luZG93KS5vbigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgICAgICAgaWYoJCgnLmZ1bGxzY3JlYW4tbWVudScpLmhhc0NsYXNzKCdhY3RpdmUnKSkgcmV0dXJuXHJcbiAgICAgICAgY29uc3QgdGFnTmFtZSA9IGUudGFyZ2V0LnRhZ05hbWUudG9Mb2NhbGVMb3dlckNhc2UoKTtcclxuICAgICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgICAgICAgaWYodGFnTmFtZSAhPT0gXCJpbnB1dFwiICYmIHRhZ05hbWUgIT09IFwidGV4dGFyZWFcIil7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgMzg6XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxlci5wcmV2KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgNDA6XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxlci5uZXh0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH0pO1xyXG5cclxuICAgICQoJ1tkYXRhLXNjcm9sbC10b10nKS5jbGljayhlID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICBcclxuICAgICAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKCdkYXRhLXNjcm9sbC10bycpO1xyXG4gICAgICAgIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcclxuXHJcbiAgICAgICAgcGVyZm9tVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xyXG4gICAgICAgIGlmKCQoJy5mdWxsc2NyZWFuLW1lbnUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJykpIHJldHVyblxyXG4gICAgfSlcclxuXHJcbiAgICAkKFwiYm9keVwiKS5zd2lwZSgge1xyXG4gICAgc3dpcGU6IGZ1bmN0aW9uIChldmVudCwgZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcbiAgICAgICAgbGV0IHNjcm9sbERpcmVjdGlvbiA9ICcnO1xyXG5cclxuICAgICAgICBpZihkaXJlY3Rpb24gPT09ICd1cCcpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xyXG4gICAgICAgIGlmKGRpcmVjdGlvbiA9PT0gJ2Rvd24nKSBzY3JvbGxEaXJlY3Rpb24gPSBcInByZXZcIjtcclxuXHJcbiAgICAgICAgc2Nyb2xsZXJbc2Nyb2xsRGlyZWN0aW9uXSgpO1xyXG4gICAgfVxyXG4gICAgfSk7XHJcbn0pKCk7IiwiOyhmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdHMnKTtcclxuICAgIGNvbnN0IGl0ZW1zQ291bnQgPSAkKCcucHJvZHVjdC1pdGVtJykubGVuZ3RoO1xyXG4gICAgY29uc3QgYXJyb3dzID0gJCgnLnByb2R1Y3Qtc2xpZGVyX19hcnJvd3MnKTtcclxuICAgIGNvbnN0IGFycm93TGVmdCA9ICQoJy5wcm9kdWN0LXNsaWRlcl9fYXJyb3ctLWxlZnQnKTtcclxuICAgIGNvbnN0IGFycm93UmlnaHQgPSAkKCcucHJvZHVjdC1zbGlkZXJfX2Fycm93LS1yaWdodCcpO1xyXG5cclxuICAgIGxldCBzdGFydEluZGV4ID0gMDtcclxuICAgIGNvbnN0IHdpZHRoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtaXRlbScpLmNsaWVudFdpZHRoO1xyXG5cclxuXHJcbiAgICBhcnJvd0xlZnQub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgIGlmKHN0YXJ0SW5kZXggPiAwKXtcclxuICAgICAgICAgICAgICBzdGFydEluZGV4LS07XHJcbiAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgc3RhcnRJbmRleCA9IGl0ZW1zQ291bnQgLTE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgIHNsaWRlci5zdHlsZS5sZWZ0ID0gXCItXCIgKyBzdGFydEluZGV4ICogd2lkdGggKyBcInB4XCI7ICAgXHJcbiAgICB9KTtcclxuXHJcbiAgICBhcnJvd1JpZ2h0Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICBcclxuICAgICBpZihzdGFydEluZGV4ICE9PSBpdGVtc0NvdW50IC0gMSl7XHJcbiAgICAgICAgIHN0YXJ0SW5kZXgrKztcclxuICAgICB9IGVsc2V7XHJcbiAgICAgICAgIHN0YXJ0SW5kZXg9MDtcclxuICAgICB9XHJcblxyXG4gICAgICAgICBzbGlkZXIuc3R5bGUubGVmdCA9IFwiLVwiICsgc3RhcnRJbmRleCAqIHdpZHRoICsgXCJweFwiO1xyXG4gICAgfSk7XHJcbn0pKCk7IiwiOyhmdW5jdGlvbiAoKSB7IFxyXG4gICAgJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICBjb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gKGFsaWFzKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKCcucmV2aWV3c19faXRlbScpLmZpbHRlcigobmR4LCBpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAgJChpdGVtKS5hdHRyKCdkYXRhLWxpbmtlZC13aXRoJykgPT09IGFsaWFzO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkKCcuaW50ZXJhY3RpdmUtYXZhdGFyX19saW5rJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cignZGF0YS1vcGVuJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNob3dJdGVtID0gZmluZEJsb2NrQnlBbGlhcyh0YXJnZXQpO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJJdGVtID0gJHRoaXMuY2xvc2VzdCgnLnJldmlld3NfX3N3aXRjaGNlci1pdGVtJyk7XHJcblxyXG4gICAgICAgICAgICBzaG93SXRlbS5hZGRDbGFzcygnYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxufSkoKTsiXX0=
